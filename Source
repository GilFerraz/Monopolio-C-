/*
Copyright 2014-2015, Gil Ferraz e Teresa Loureiro
*/

#include<stdio.h>
#include<stdlib.h>
#include<string.h>

//Estrutura de dados para o registo de Propriedades
typedef struct registoPropriedades
{
	char nome[50];
	int preço;
	int hipoteca;
	char localizaçao[50];
	char proprietario[20];
} Propriedade;

Propriedade propriedades[39];

//Estrutura de dados para o registo de Jogadores
typedef struct registoJogadores
{
	char nome[50];
	int saldo;
	int posicao;
} Jogador;

Jogador jogadores[8];

//Cadeia
bool cadeia()
{
	printf("Necessita de fazer um double para sair da cadeia.");
	int dado1, dado2, total;

	dado1 = (rand() % 6) + 1;
	dado2 = (rand() % 6) + 1;
	total = dado1 + dado2;
	if (dado1 == dado2)
	{
		printf("Saiu da cadeia!");
		return false;
	}
	else return true;
}

//Lançamento dos dois dados
int lançamentoDados()
{
	int dado1, dado2, total, contador = 0;

	dado1 = (rand() % 6) + 1;
	dado2 = (rand() % 6) + 1;
	total = dado1 + dado2;
	printf("Lançamento de Dados: %d + %d = %d casas.\n", dado1, dado2, total);

	//Verificar se ocorreu um double
	while (dado1 == dado2)
	{
		printf("DOUBLE!\n\n");
		contador++;
		if (contador == 3)
		{
			//Vai cadeia se tiver 3 doubles seguidos
			printf("Obteve 3 doubles seguidos, vai para a cadeia.\n");
			cadeia();
			break;
		}
		else
		{
			dado1 = (rand() % 6) + 1;
			dado2 = (rand() % 6) + 1;
			total = dado1 + dado2;
			printf("Lançamento de Dados: %d + %d = %d casas.\n", dado1, dado2, total);
		}
	}
	return(total);
}

//Seleção de Jogoadoes
void seleçãoJogadores()
{
	int nJogadores;

	printf("Qual e o numero de jogadores (2 a 8): ");
	scanf_s("%d", &nJogadores);
	printf("\n");

	while ((nJogadores < 2) || (nJogadores > 8))
	{
		printf("ERRO! Dados invalidos.\n");
		printf("Qual e o numero de jogadores (2 a 8): ");
		scanf_s("%d", &nJogadores);
	}

	for (int i = 0; i > nJogadores; i++)
	{
		printf("Qual e o nome do jogador %d: ", i);
		scanf_s("%d", jogadores[i].nome);
		jogadores[i].saldo = 0;
		jogadores[i].posicao = 0;
	}
}

//Calcula a nova posição do Jogador após o Lançamento dos Dados
int novaPosicao(int posActual, int lancamentoDados)
{
	int novaPos = posActual + lancamentoDados;

	if (novaPos == 40)
	{
		novaPos = 0;
		return (novaPos);
	}
	else if (novaPos > 40) return(novaPos - 40);
	else return novaPos;
}

//Contador universal de turnos
int turno = 0;

//Executa as ações possíveis por turno
void novoTurno() 
{ //INCOMPLETO
	turno++;
	printf("\n== Turno %d ==\n", turno);

	for each (Jogador a in jogadores)
	{
		if (jogadores[a].posição == 0) jogadores[a].saldo += 200;
	}
	lançamentoDados();

} //INCOMPLETO

void main()
{
	//Definição de Casas e Propriedades
	//Casa 0 - Partida


	//Casa 1
	strcpy(propriedades[1].nome, "Campo Grande");
	propriedades[1].preço = 60;
	propriedades[1].hipoteca = 5;
	strcpy(propriedades[1].localizaçao, "Lisboa");
	strcpy(propriedades[1].proprietario, "");

	//Casa 2
	strcpy(propriedades[2].nome,"Rua Faria Guimarães");
	propriedades[2].preço = 60;
	propriedades[2].hipoteca = 5;
	strcpy(propriedades[2].localizaçao,"Porto");
	strcpy(propriedades[2].proprietario,"");

	//Casa 3 - Pague imposto sobre capitais 200$

	
	//Casa 4
	strcpy(propriedades[4].nome, "Estação do Rossio");
	propriedades[4].preço = 200;
	propriedades[4].hipoteca = 50;
	strcpy(propriedades[4].localizaçao, "Lisboa");
	strcpy(propriedades[4].proprietario, "");

	//Casa 5
	strcpy(propriedades[5].nome, "Alamedas das Linhas de Torres");
	propriedades[5].preço = 100;
	propriedades[5].hipoteca = 50;
	strcpy(propriedades[5].localizaçao, "Lisboa");
	strcpy(propriedades[5].proprietario, "");
	
	//Casa 6 - Sorte


	//Casa 7
	strcpy(propriedades[7].nome, "Avenida das Nações Unidas");
	propriedades[7].preço = 100;
	propriedades[7].hipoteca = 50;
	strcpy(propriedades[7].localizaçao, "Lisboa");
	strcpy(propriedades[7].proprietario, "");

	//Casa 8
	strcpy(propriedades[8].nome, "Avenida 24 de Julho");
	propriedades[8].preço = 120;
	propriedades[8].hipoteca = 50;
	strcpy(propriedades[8].localizaçao, "Lisboa");
	strcpy(propriedades[8].proprietario, "");

	//Casa 9 - Cadeia
	strcpy(propriedades[8].nome, "Cadeia");
	propriedades[8].preço = 0;
	propriedades[8].hipoteca = 0;
	strcpy(propriedades[8].localizaçao, "");
	strcpy(propriedades[8].proprietario, "Interdito");

	//Casa 10
	strcpy(propriedades[10].nome, "Avenida Central");
	propriedades[10].preço = 140;
	propriedades[10].hipoteca = 50;
	strcpy(propriedades[10].localizaçao, "Braga");
	strcpy(propriedades[10].proprietario, "");

	//Casa 11 - Companhia de eletricidade 150


	//Casa 12
	strcpy(propriedades[12].nome, "Rua Ferreira Borges");
	propriedades[12].preço = 140;
	propriedades[12].hipoteca = 50;
	strcpy(propriedades[12].localizaçao, "Coimbra");
	strcpy(propriedades[12].proprietario, "");

	//Casa 13
	strcpy(propriedades[13].nome, "Avenida de Roma");
	propriedades[13].preço = 160;
	propriedades[13].hipoteca = 50;
	strcpy(propriedades[13].localizaçao, "Lisboa");
	strcpy(propriedades[13].proprietario, "");

	//Casa 14
	strcpy(propriedades[14].nome, "Gare do Oriente");
	propriedades[14].preço = 200;
	propriedades[14].hipoteca = 50;
	strcpy(propriedades[14].localizaçao, "Lisboa");
	strcpy(propriedades[14].proprietario, "");

	//Casa 15
	strcpy(propriedades[15].nome, "Avenida da Boavista");
	propriedades[15].preço = 180;
	propriedades[15].hipoteca = 50;
	strcpy(propriedades[15].localizaçao, "Porto");
	strcpy(propriedades[15].proprietario, "");
	
	//Casa 16 - Caixa da Comunidade


	//Casa 17
	strcpy(propriedades[17].nome, "Avenida da República");
	propriedades[17].preço = 180;
	propriedades[17].hipoteca = 50;
	strcpy(propriedades[17].localizaçao, "Lisboa");
	strcpy(propriedades[17].proprietario, "");

	//Casa 18
	strcpy(propriedades[18].nome, "Rua Mouzinho da Silveira");
	propriedades[18].preço = 200;
	propriedades[18].hipoteca = 50;
	strcpy(propriedades[18].localizaçao, "Porto");
	strcpy(propriedades[18].proprietario, "");

	//Casa 19 - Estacionamento Livre


	//Casa 20
	strcpy(propriedades[20].nome, "Rua de Santa Catarina");
	propriedades[20].preço = 220;
	propriedades[20].hipoteca = 50;
	strcpy(propriedades[20].localizaçao, "Porto");
	strcpy(propriedades[20].proprietario, "");

	//Casa 21 - Sorte


	//Casa 22
	strcpy(propriedades[22].nome, "Avenida Infante Santo");
	propriedades[22].preço = 220;
	propriedades[22].hipoteca = 50;
	strcpy(propriedades[22].localizaçao, "Lisboa");
	strcpy(propriedades[22].proprietario, "");

	//Casa 23
	strcpy(propriedades[23].nome, "Rua Julio Diniz");
	propriedades[23].preço = 240;
	propriedades[23].hipoteca = 50;
	strcpy(propriedades[23].localizaçao, "Porto");
	strcpy(propriedades[23].proprietario, "");

	//Casa 24
	strcpy(propriedades[24].nome, "Estação de S. Bento");
	propriedades[24].preço = 200;
	propriedades[24].hipoteca = 50;
	strcpy(propriedades[24].localizaçao, "Porto");
	strcpy(propriedades[24].proprietario, "");

	//Casa 25
	strcpy(propriedades[25].nome, "Praça da Republica");
	propriedades[25].preço = 260;
	propriedades[25].hipoteca = 50;
	strcpy(propriedades[25].localizaçao, "Porto");
	strcpy(propriedades[25].proprietario, "");

	//Casa 26
	strcpy(propriedades[26].nome, "Avenida Fontes Pereira de Melo");
	propriedades[26].preço = 260;
	propriedades[26].hipoteca = 50;
	strcpy(propriedades[26].localizaçao, "Lisboa");
	strcpy(propriedades[26].proprietario, "");

	//Casa 27 - Companhia das Águas


	//Casa 28
	strcpy(propriedades[28].nome, "Rotunda da Boavista");
	propriedades[28].preço = 280;
	propriedades[28].hipoteca = 50;
	strcpy(propriedades[28].localizaçao, "Porto");
	strcpy(propriedades[28].proprietario, "");


	//Casa 29 - Vá para a cadeia


	//Casa 30
	strcpy(propriedades[30].nome, "Avenida da Liberdade");
	propriedades[30].preço = 300;
	propriedades[30].hipoteca = 50;
	strcpy(propriedades[30].localizaçao, "Lisboa");
	strcpy(propriedades[30].proprietario, "");

	//Casa 31
	strcpy(propriedades[31].nome, "Rua dos Clerigos");
	propriedades[31].preço = 300;
	propriedades[31].hipoteca = 50;
	strcpy(propriedades[31].localizaçao, "Porto");
	strcpy(propriedades[31].proprietario, "");

	//Casa 32 - Caixa da comunidade


	//Casa 33
	strcpy(propriedades[33].nome, "Avenida do Parque das Nações");
	propriedades[33].preço = 320;
	propriedades[33].hipoteca = 50;
	strcpy(propriedades[33].localizaçao, "Lisboa");
	strcpy(propriedades[33].proprietario, "");

	//Casa 34
	strcpy(propriedades[34].nome, "Estação de Santa Apolonia");
	propriedades[34].preço = 200;
	propriedades[34].hipoteca = 50;
	strcpy(propriedades[34].localizaçao, "Lisboa");
	strcpy(propriedades[34].proprietario, "");

	//Casa 35 - Sorte


	//Casa 36
	strcpy(propriedades[36].nome, "Rua das Amoreiras");
	propriedades[36].preço = 200;
	propriedades[36].hipoteca = 50;
	strcpy(propriedades[36].localizaçao, "Lisboa");
	strcpy(propriedades[36].proprietario, "");

	//Casa 37 - Imposto de Luxo


	//Casa38
	strcpy(propriedades[38].nome, "Rossio");
	propriedades[38].preço = 400;
	propriedades[38].hipoteca = 50;
	strcpy(propriedades[38].localizaçao, "Lisboa");
	strcpy(propriedades[38].proprietario, "");

	//Início do Jogo
	printf("= MONOPOLIO =\n");
	printf("Bem-vindo ao Monopolio para a Consola do Windows.\n");
	printf("Este jogo foi codificado em liguagem C no ambito da disciplina de\n");
	printf("Algoritmos e Estrutura de Dados, lecionada pelo professor Jose Carlos,\n");
	printf("UC da Licenciatura de Engenharia em Desenvolvimento de Jogos Digitais.\n");
	printf("\nAutores: Gil Ferraz (10660) e Teresa Loureiro (10661)\n");

	printf("\n== Jogadores ==\n");
	seleçãoJogadores();

	turno();
	
	system("pause");
}
