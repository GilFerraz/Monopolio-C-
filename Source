
Copyright 2014-2015, Gil Ferraz e Teresa Loureiro
*/

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

//Estrutura de dados para o registo de Propriedades
typedef struct registoPropriedades
{
	char nome[50];
	int preço;
	int hipoteca;
	bool estadoHipoteca;
	char cor[10];
	char localizaçao[50];
	char proprietario[20];
} Propriedade;

Propriedade propriedades[40];

//Estrutura de dados para o registo de Jogadores
typedef struct registoJogadores
{
	char nome[50];
	int saldo;
	int posição;
} Jogador;

Jogador jogadores[8];

//Cadeia
bool cadeia()
{
	printf("Necessita de fazer um double para sair da cadeia.");
	int dado1, dado2, total;

	dado1 = (rand() % 6) + 1;
	dado2 = (rand() % 6) + 1;
	total = dado1 + dado2;
	if (dado1 == dado2)
	{
		printf("Saiu da cadeia!");
		return false;
	}
	else return true;
}

//Lançamento de dois dados
int lançamentoDados()
{
	int dado1 = (rand() % 6) + 1;
	int dado2 = (rand() % 6) + 1;
	int total1 = dado1 + dado2;
	printf("\n== 1 - Lançamento de Dados ==\n");
	printf(" * Primeiro Lancamento: %d + %d = %d casas\n", dado1, dado2, total1);

	if (dado1 != dado2)
	{
		printf("\nAvance %d casas.\n", total1);
		return (total1);
	}
	else
	{
		printf(" DOUBLE!\n\n");
		dado1 = (rand() % 6) + 1;
		dado2 = (rand() % 6) + 1;
		int total2 = dado1 + dado2;
		printf(" * Segundo Lancamento: %d + %d = %d casas\n", dado1, dado2, total2);

		if (dado1 != dado2)
		{
			printf("\nAvance %d casas.\n", total1 + total2);
			return (total1 + total2);
		}
		else
		{
			printf(" DOUBLE!\n\n");
			dado1 = (rand() % 6) + 1;
			dado2 = (rand() % 6) + 1;
			int total3 = dado1 + dado2;
			printf(" * Terceiro Lancamento: %d + %d = %d casas\n", dado1, dado2, total3);

			if (dado1 != dado2)
			{
				printf("\nAvance %d casas.\n", total1 + total2 + total3);
				return (total1 + total2 + total3);
			}
			else
			{
				printf("Obteve 3 DOUBLES consecutivos. Vai para a cadeia!\n");
				cadeia();
			}
		}
	}
}

//Seleção de Jogoadoes
int seleçãoJogadores()
{
	int nJogadores;

	printf("Qual e o numero de jogadores (2 a 8): ");
	scanf_s("%d", &nJogadores);
	printf("\n");

	while ((nJogadores < 2) || (nJogadores > 8))
	{
		printf("ERRO! %d nao e um numero de jogadores valido.\n", nJogadores);
		printf("Qual e o numero de jogadores (2 a 8): ");
		scanf_s("%d", &nJogadores);
	}
	getchar();
	for (int i = 0; i < nJogadores; i++)
	{
		printf("Qual e o nome do jogador %d: ", i + 1);
		/*scanf_s("%c", jogadores[i].nome)*/
		gets_s(jogadores[i].nome, 50);
		jogadores[i].saldo = 1500;
		jogadores[i].posição = 0;
	}
	return (nJogadores);
}

//Calcula a nova posição do Jogador após o Lançamento dos Dados
int novaPosicao(int posActual, int lancamentoDados)
{
	int novaPos = posActual + lancamentoDados;

	if (novaPos == 40)
	{
		novaPos = 0;
		return (novaPos);
	}
	else if (novaPos > 40) return(novaPos - 40);
	else return novaPos;
}
// Remoção do elemento presente no topo da pilha CARTAS
int popSorte(i=0, saldo=0, )
{
	if (quantidade > 0)
	{
		switch (baralho[quantidade - 1].tipo)
		{
		case 'a':
			jogadores[i].posição = 0;
			saldo = saldo + 200;
			break;
		}
		quantidade--; return(1);
	}
}

void main()
{
	//== Definição de Propriedades ==
	//Casa 0 - PARTIDA
	strcpy(propriedades[0].nome, "Inicio");
	propriedades[0].preço = 0;
	propriedades[0].hipoteca = 0;
	propriedades[0].estadoHipoteca = false;
	strcpy(propriedades[0].cor, "Sem Cor");
	strcpy(propriedades[0].localizaçao, "Sem Localização");
	strcpy(propriedades[0].proprietario, "Interdito");

	//Casa 1
	strcpy(propriedades[1].nome, "Campo Grande");
	propriedades[1].preço = 60;
	propriedades[1].hipoteca = 5;
	propriedades[1].estadoHipoteca = false;
	strcpy(propriedades[1].cor, "Castanho");
	strcpy(propriedades[1].localizaçao, "Lisboa");
	strcpy(propriedades[1].proprietario, "Sem Proprietario");

	//Casa 2 - CAIXA DA COMUNIDADE

	//Casa 3
	strcpy(propriedades[3].nome,"Rua Faria Guimaraes");
	propriedades[3].preço = 60;
	propriedades[3].hipoteca = 5;
	propriedades[3].estadoHipoteca = false;
	strcpy(propriedades[3].cor, "Castanho");
	strcpy(propriedades[3].localizaçao,"Porto");
	strcpy(propriedades[3].proprietario,"Sem Proprietario");

	//Casa 4 - IMPOSTO SOBRE CAPITAIS (200$ ou 10%)

	
	//Casa 5 - ESTAÇÃO
	strcpy(propriedades[5].nome, "Estacao do Rossio");
	propriedades[5].preço = 200;
	propriedades[5].hipoteca = 50;
	propriedades[5].estadoHipoteca = false;
	strcpy(propriedades[5].cor, "Estacao");
	strcpy(propriedades[5].localizaçao, "Lisboa");
	strcpy(propriedades[5].proprietario, "Sem Proprietario");

	//Casa 6
	strcpy(propriedades[6].nome, "Alameda das Linhas de Torres");
	propriedades[6].preço = 100;
	propriedades[6].hipoteca = 50;
	propriedades[6].estadoHipoteca = false;
	strcpy(propriedades[6].cor, "Azul claro");
	strcpy(propriedades[6].localizaçao, "Lisboa");
	strcpy(propriedades[6].proprietario, "Sem Proprietario");
	
	//Casa 7 - SORTE


	//Casa 8
	strcpy(propriedades[8].nome, "Avenida das Nacoes Unidas");
	propriedades[8].preço = 100;
	propriedades[8].hipoteca = 50;
	propriedades[8].estadoHipoteca = false;
	strcpy(propriedades[8].cor, "Azul claro");
	strcpy(propriedades[8].localizaçao, "Lisboa");
	strcpy(propriedades[8].proprietario, "Sem Proprietario");

	//Casa 9
	strcpy(propriedades[9].nome, "Avenida 24 de Julho");
	propriedades[9].preço = 120;
	propriedades[9].hipoteca = 50;
	propriedades[9].estadoHipoteca = false;
	strcpy(propriedades[9].cor, "Azul claro");
	strcpy(propriedades[9].localizaçao, "Lisboa");
	strcpy(propriedades[9].proprietario, "Sem Proprietario");

	//Casa 10 - CADEIA / DE VISITA
	strcpy(propriedades[10].nome, "Cadeia");
	propriedades[10].preço = 0;
	propriedades[10].hipoteca = 0;
	propriedades[10].estadoHipoteca = false;
	strcpy(propriedades[10].cor, "Sem Cor");
	strcpy(propriedades[10].localizaçao, "Sem Localizacao");
	strcpy(propriedades[10].proprietario, "Interdito");

	//Casa 11
	strcpy(propriedades[11].nome, "Avenida Central");
	propriedades[11].preço = 140;
	propriedades[11].hipoteca = 50;
	propriedades[11].estadoHipoteca = false;
	strcpy(propriedades[11].cor, "Rosa");
	strcpy(propriedades[11].localizaçao, "Braga");
	strcpy(propriedades[11].proprietario, "Sem Proprietario");

	//Casa 12 - COMPANHIA DA ELETRECIDADE
	strcpy(propriedades[12].nome, "Companhia de Eletricidade");
	propriedades[12].preço = 150;
	propriedades[12].hipoteca = 0;
	propriedades[12].estadoHipoteca = false;
	strcpy(propriedades[12].cor, "Servicos");
	strcpy(propriedades[12].localizaçao, "Sem Localizacao");
	strcpy(propriedades[12].proprietario, "Sem Proprietario");

	//Casa 13
	strcpy(propriedades[13].nome, "Rua Ferreira Borges");
	propriedades[13].preço = 140;
	propriedades[13].hipoteca = 50;
	propriedades[13].estadoHipoteca = false;
	strcpy(propriedades[13].cor, "Rosa");
	strcpy(propriedades[13].localizaçao, "Coimbra");
	strcpy(propriedades[13].proprietario, "Sem Proprietario");

	//Casa 14
	strcpy(propriedades[14].nome, "Avenida de Roma");
	propriedades[14].preço = 160;
	propriedades[14].hipoteca = 50;
	propriedades[14].estadoHipoteca = false;
	strcpy(propriedades[14].cor, "Rosa");
	strcpy(propriedades[14].localizaçao, "Lisboa");
	strcpy(propriedades[14].proprietario, "Sem Proprietario");

	//Casa 15 - ESTAÇÃO
	strcpy(propriedades[15].nome, "Gare do Oriente");
	propriedades[15].preço = 200;
	propriedades[15].hipoteca = 50;
	propriedades[15].estadoHipoteca = false;
	strcpy(propriedades[15].cor, "Estacao");
	strcpy(propriedades[15].localizaçao, "Lisboa");
	strcpy(propriedades[15].proprietario, "Sem Proprietario");

	//Casa 16
	strcpy(propriedades[16].nome, "Avenida da Boavista");
	propriedades[16].preço = 180;
	propriedades[16].hipoteca = 50;
	propriedades[16].estadoHipoteca = false;
	strcpy(propriedades[16].cor, "Laranja");
	strcpy(propriedades[16].localizaçao, "Porto");
	strcpy(propriedades[16].proprietario, "Sem Proprietario");
	
	//Casa 17 - CAIXA DA COMUNIDADE


	//Casa 18
	strcpy(propriedades[18].nome, "Avenida da Republica");
	propriedades[18].preço = 180;
	propriedades[18].hipoteca = 50;
	propriedades[18].estadoHipoteca = false;
	strcpy(propriedades[18].cor, "Laranja");
	strcpy(propriedades[18].localizaçao, "Lisboa");
	strcpy(propriedades[18].proprietario, "Sem Proprietario");

	//Casa 19
	strcpy(propriedades[19].nome, "Rua Mouzinho da Silveira");
	propriedades[19].preço = 200;
	propriedades[19].hipoteca = 50;
	propriedades[19].estadoHipoteca = false;
	strcpy(propriedades[19].cor, "Laranja");
	strcpy(propriedades[19].localizaçao, "Porto");
	strcpy(propriedades[19].proprietario, "Sem Proprietario");

	//Casa 20 - ESTACIONAMENTO LIVRE
	strcpy(propriedades[20].nome, "Estacionamento Livre");
	propriedades[20].preço = 0;
	propriedades[20].hipoteca = 0;
	propriedades[20].estadoHipoteca = false;
	strcpy(propriedades[20].cor, "Sem Cor");
	strcpy(propriedades[20].localizaçao, "Sem Localizacao");
	strcpy(propriedades[20].proprietario, "Sem Proprietario");

	//Casa 21
	strcpy(propriedades[21].nome, "Rua de Santa Catarina");
	propriedades[21].preço = 220;
	propriedades[21].hipoteca = 50;
	propriedades[21].estadoHipoteca = false;
	strcpy(propriedades[21].cor, "Vermelho");
	strcpy(propriedades[21].localizaçao, "Porto");
	strcpy(propriedades[21].proprietario, "Sem Proprietario");

	//Casa 22 - SORTE


	//Casa 23
	strcpy(propriedades[23].nome, "Avenida Infante Santo");
	propriedades[23].preço = 220;
	propriedades[23].hipoteca = 50;
	propriedades[23].estadoHipoteca = false;
	strcpy(propriedades[23].cor, "Vermelho");
	strcpy(propriedades[23].localizaçao, "Lisboa");
	strcpy(propriedades[23].proprietario, "Sem Proprietario");

	//Casa 24
	strcpy(propriedades[24].nome, "Rua Julio Diniz");
	propriedades[24].preço = 240;
	propriedades[24].hipoteca = 50;
	propriedades[24].estadoHipoteca = false;
	strcpy(propriedades[24].cor, "Vermelho");
	strcpy(propriedades[24].localizaçao, "Porto");
	strcpy(propriedades[24].proprietario, "Sem Proprietario");

	//Casa 25 - ESTAÇÂO
	strcpy(propriedades[25].nome, "Estacao de S. Bento");
	propriedades[25].preço = 200;
	propriedades[25].hipoteca = 50;
	propriedades[25].estadoHipoteca = false;
	strcpy(propriedades[25].cor, "Estacao");
	strcpy(propriedades[25].localizaçao, "Porto");
	strcpy(propriedades[25].proprietario, "Sem Proprietario");

	//Casa 26
	strcpy(propriedades[26].nome, "Praca da Republica");
	propriedades[26].preço = 260;
	propriedades[26].hipoteca = 50;
	propriedades[26].estadoHipoteca = false;
	strcpy(propriedades[26].cor, "Amarelo");
	strcpy(propriedades[26].localizaçao, "Porto");
	strcpy(propriedades[26].proprietario, "Sem Proprietario");

	//Casa 27
	strcpy(propriedades[27].nome, "Avenida Fontes Pereira de Melo");
	propriedades[27].preço = 260;
	propriedades[27].hipoteca = 50;
	propriedades[27].estadoHipoteca = false;
	strcpy(propriedades[27].cor, "Amarelo");
	strcpy(propriedades[27].localizaçao, "Lisboa");
	strcpy(propriedades[27].proprietario, "Sem Proprietario");

	//Casa 28 - COMPANHIA DAS ÁGUAS
	strcpy(propriedades[28].nome, "Companhia das Aguas");
	propriedades[28].preço = 150;
	propriedades[28].hipoteca = 50;
	propriedades[28].estadoHipoteca = false;
	strcpy(propriedades[28].cor, "Servicos");
	strcpy(propriedades[28].localizaçao, "Sem Localizacao");
	strcpy(propriedades[28].proprietario, "Sem Proprietario");

	//Casa 29
	strcpy(propriedades[29].nome, "Rotunda da Boavista");
	propriedades[29].preço = 280;
	propriedades[29].hipoteca = 50;
	propriedades[29].estadoHipoteca = false;
	strcpy(propriedades[29].cor, "Amarelo");
	strcpy(propriedades[29].localizaçao, "Porto");
	strcpy(propriedades[29].proprietario, "Sem Proprietario");

	//Casa 30 - VÁ PARA A CADEIA


	//Casa 31
	strcpy(propriedades[31].nome, "Avenida da Liberdade");
	propriedades[31].preço = 300;
	propriedades[31].hipoteca = 50;
	propriedades[31].estadoHipoteca = false;
	strcpy(propriedades[31].cor, "Verde");
	strcpy(propriedades[31].localizaçao, "Lisboa");
	strcpy(propriedades[31].proprietario, "Sem Proprietario");

	//Casa 32
	strcpy(propriedades[32].nome, "Rua dos Clerigos");
	propriedades[32].preço = 300;
	propriedades[32].hipoteca = 50;
	propriedades[32].estadoHipoteca = false;
	strcpy(propriedades[32].cor, "Verde");
	strcpy(propriedades[32].localizaçao, "Porto");
	strcpy(propriedades[32].proprietario, "Sem Proprietario");

	//Casa 33 - CAIXA DA COMUNIDADE


	//Casa 34
	strcpy(propriedades[34].nome, "Avenida do Parque das Nacoes");
	propriedades[34].preço = 320;
	propriedades[34].hipoteca = 50;
	propriedades[34].estadoHipoteca = false;
	strcpy(propriedades[34].cor, "Verde");
	strcpy(propriedades[34].localizaçao, "Lisboa");
	strcpy(propriedades[34].proprietario, "Sem Proprietario");

	//Casa 35 - ESTAÇÃO
	strcpy(propriedades[35].nome, "Estacao de Santa Apolonia");
	propriedades[35].preço = 200;
	propriedades[35].hipoteca = 50;
	propriedades[35].estadoHipoteca = false;
	strcpy(propriedades[35].cor, "Estacao");
	strcpy(propriedades[35].localizaçao, "Lisboa");
	strcpy(propriedades[35].proprietario, "Sem Proprietario");

	//Casa 36 - SORTE


	//Casa 37
	strcpy(propriedades[37].nome, "Rua das Amoreiras");
	propriedades[37].preço = 350;
	propriedades[37].hipoteca = 50;
	propriedades[37].estadoHipoteca = false;
	strcpy(propriedades[37].cor, "Azul escuro");
	strcpy(propriedades[37].localizaçao, "Lisboa");
	strcpy(propriedades[37].proprietario, "Sem Proprietario");

	//Casa 38 - IMPOSTO DE LUXO


	//Casa 39
	strcpy(propriedades[39].nome, "Rossio");
	propriedades[39].preço = 400;
	propriedades[39].hipoteca = 50;
	propriedades[39].estadoHipoteca = false;
	strcpy(propriedades[39].cor, "Azul escuro");
	strcpy(propriedades[39].localizaçao, "Lisboa");
	strcpy(propriedades[39].proprietario, "Sem Proprietario");

	//Início do Jogo
	printf("= MONOPOLIO =\n");
	printf("Bem-vindo ao Monopolio para a Consola do Windows.\n");
	printf("Este jogo foi codificado em liguagem C no ambito da disciplina de\n");
	printf("Algoritmos e Estrutura de Dados, lecionada pelo professor Jose Carlos,\n");
	printf("UC da Licenciatura de Engenharia em Desenvolvimento de Jogos Digitais.\n");
	printf("\nAutores: Gil Ferraz (10660) e Teresa Loureiro (10661)\n");

	printf("\n== Selecao de Jogadores ==\n");
	int nJogadores = seleçãoJogadores();
	
	int turno = 10;
	//Execução de turnos
	do
	{
		printf("\n== Turno %d ==\n", turno);

		for (int i = 0; i < nJogadores; i++)
		{
			printf("\n=== Jogador %d - %s ===\n", i + 1, jogadores[i].nome);
			printf(" * Saldo = %d euros\n", jogadores[i].saldo);
			printf(" * Posicao = Casa %d - %s\n", jogadores[i].posição, propriedades[jogadores[i].posição].nome);

			//Escolha de opção
			int opção = 0;

			printf("\nO que deseja fazer?\n");
			printf("1 - Lancar os dados\n");
			if (strcmp(propriedades[jogadores[i].posição].proprietario, "Sem Proprietario") == 0)
				printf("2 - Comprar propriedade\n");
			if (propriedades[jogadores[i].posição].proprietario == jogadores[i].nome)
			{
				printf("3 - Construir casa\n");
				printf("4 - Construir hotel\n");
			}
			scanf_s("%d", &opção);

			//Lançamento de dados e cálculo da nova posição do jogador
			int antigaPosição = jogadores[i].posição;
			
			jogadores[i].posição = novaPosicao(jogadores[i].posição, lançamentoDados());
			switch (jogadores[i].posição)
			{
			case 's':
				popSorte();
				break;
			}
			printf("\n== Movimentos ==\n");
			printf(" * Posicao = Casa %d - %s\n", jogadores[i].posição, propriedades[jogadores[i].posição].nome);

			//Detalhes da casa em que o jogador se encontra
			printf("\n== %s ==\n", propriedades[jogadores[i].posição].nome);
			printf(" * Preco: %d\n", propriedades[jogadores[i].posição].preço);
			printf(" * Hipoteca: %d\n", propriedades[jogadores[i].posição].hipoteca);
			printf(" * Localizacao: %s\n", propriedades[jogadores[i].posição].localizaçao);

			//Escolha de opção
			opção = 0;

			printf("\nO que deseja fazer?\n");
			if (strcmp(propriedades[jogadores[i].posição].proprietario, "Sem Proprietario") == 0)
				printf("2 - Comprar propriedade\n");

			if (propriedades[jogadores[i].posição].proprietario == jogadores[i].nome)
			{
				printf("3 - Construir casa\n");
				printf("4 - Construir hotel\n");
			}
			printf("0 - Terminar turno\n");
			scanf_s("%d", &opção);

			//Comprar propriedade
			if (opção = 2)
			{
				if (jogadores[i].saldo >= propriedades[jogadores[i].posição].preço)
				{
					jogadores[i].saldo -= propriedades[jogadores[i].posição].preço;
					strcpy(propriedades[jogadores[i].posição].proprietario, jogadores[i].nome);

					printf("\nAquisicao completa!\n");
					printf("%s foi adiquirida por %s.\n", propriedades[jogadores[i].posição].nome, jogadores[i].nome);
				}
			}

			//Verficar se o jogador se encontra ou passou pela Casa de Partida
			if ((jogadores[i].posição == 0) || (jogadores[i].posição < antigaPosição))
			{
				printf("\n Passou pelo casa Partida. Recebe 200 euros.\n");
				jogadores[i].saldo += 200;
				printf(" * Saldo = %d euros\n", jogadores[i].saldo);
			}
			printf("\n\n\n");
		}
	} while (turno != 100);

	system("pause");
}
